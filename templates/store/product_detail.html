{% extends 'base.html' %}
{% load static %}


{% block content %}


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Boat Wireless Speaker â€“ Product Detail</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --v1-100-bg:#f5f6f8; 
      --v1-110-card:#ffffff; 
      --v1-120-text:#0e1220; 
      --v1-130-sub:#6b7280; 
      --v1-140-brand:#2457ff; 
      --v1-150-green:#17a34a; 
      --v1-160-yellow:#f59e0b; 
      --v1-170-gray:#e5e7eb; 
      --v1-180-border:#d1d5db; 
      --v1-190-shadow:0 10px 25px rgba(16,24,40,.08);
      --v1-200-radius:18px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--v1-100-bg);color:var(--v1-120-text)}
    .v1-wrap-100{max-width:1120px;margin:20px auto;padding:0 10px}
    .v1-product-101{display:grid;grid-template-columns:600px 1fr;gap:32px;align-items:start}

    /* left gallery */
    .v1-gallery-110{display:grid;grid-template-columns:110px 1fr;gap:15px}
    .v1-thumbs-130{display:grid;gap:7px}
    .v1-thumb-131{height:110px;width:110px;border-radius:14px;background:#ddd;box-shadow:var(--v1-190-shadow);border:1px solid var(--v1-180-border)}
    /* Thumbnails should look clickable */
    .v1-thumb-131 {
      cursor: pointer;          /* pointer cursor */
      margin: 0 4px;            /* decrease gap between thumbnails */
      transition: transform 0.2s ease;
    }

    .v1-thumb-131:hover {
      transform: scale(1.05);   /* small hover zoom effect */
    }

    .v1-thumb-131.active {
     border: 2px solid #007bff;   /* highlight active */
     border-radius: 6px;
     box-shadow: 0 0 10px rgba(0, 123, 255, 0.5); /* glow effect */
    }

    .v1-hero-120{position:relative;border-radius:22px;overflow:hidden;background:linear-gradient(145deg,#e8ecff,#cfd8ff 40%,#b9c7ff);min-height:520px;display:flex;align-items:flex-end;justify-content:center;box-shadow:var(--v1-190-shadow)}
    .v1-hero-120 .v1-hero-img-121{width:100%;height:100%;object-fit:cover;display:block}
    .v1-hero-120 {
      position: relative;
      overflow: hidden;
    }

    .v1-hero-img-121 {
      width: 100%;
      cursor: zoom-in;
      transition: opacity 0.2s ease;
    }



    /* Promo text inside hero */
    .v1-hero-badge-122{position:absolute;left:16px;top:20px;color:#fff}
    .v1-hero-hrs-123{display:flex;align-items:flex-end;gap:12px}
    .v1-hero-hrs-123 .v1-num-124{font-size:140px;line-height:.85;font-weight:800;letter-spacing:-2px}
    .v1-hero-hrs-123 .v1-hrs-125{font-weight:800;font-size:32px;transform:translateY(-10px)}
    .v1-hero-play-126{font-size:20px;margin-top:-6px;letter-spacing:.08em}
    .v1-hero-foot-127{position:absolute;left:16px;bottom:16px;background:rgba(0,0,0,.25);color:#fff;padding:14px 18px;border-radius:14px;backdrop-filter:blur(4px);font-size:14px}

    /* right details */
    .v1-details-200{padding-top:4px}
    .v1-title-201{font-size:40px;line-height:1.1;margin:0 0 8px;font-weight:800}
    .v1-sub-202{color:var(--v1-130-sub);font-size:14px;margin-bottom:18px}

    .v1-price-210{display:flex;align-items:baseline;gap:14px;margin:6px 0 4px}
    .v1-price-now-211{font-size:22px;font-weight:700}
    .v1-price-sale-212{font-size:14px;color:var(--v1-130-sub)}
    .v1-price-strike-213{position:relative}
    .v1-price-strike-213::after{content:"";position:absolute;left:0;right:0;top:50%;height:2px;background:#000;opacity:.35;transform:rotate(-5deg)}
    .v1-tax-214{font-size:12px;color:var(--v1-130-sub);margin-top:2px}

    .v1-stars-220{display:flex;align-items:center;gap:8px;margin:10px 0 16px}
    .v1-stars-220 .rating-star{display:flex;flex-direction:row;margin-right:5px}
    .v1-stars-220 .rating-star i{margin:0;font-size:18px;float:none}
    .v1-stars-220 .v1-rev-222{font-size:12px;color:var(--v1-130-sub)}

    .v1-choose-230{font-size:14px;margin:18px 0 8px}
    .v1-swatches-231{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:10px}
    /* swatch pill styles */
    .v1-pill-232 {
      padding: 8px 16px;
      border-radius: 999px;
      background: #f3f4f6;
      border: 2px solid var(--v1-180-border);
      font-size: 13px;
      cursor: pointer;           /* pointer cursor */
      transition: all 0.2s ease;
    }

    .v1-pill-232.active {
      background: var(--v1-140-brand);
      color: #fff;
      border-color: var(--v1-140-brand);
      font-weight: 600;
    }
    .v1-min-240{font-size:13px;color:var(--v1-130-sub);margin:14px 0 16px}

    .v1-feats-250 {
      display: flex;
      flex-wrap: wrap;   /* allows row wrapping */
      gap: 16px;         /* space between features */
      margin: 20px 0;   /* space around section */
    }

    .v1-feat-251 {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: #111;
    }

    .v1-feat-251 .v1-ico-252 {
      font-size: 14px;
      line-height: 1.4;
      color: #111;
    }

    

    .v1-cta-260{display:flex;gap:14px}
    .v1-btn-261{flex:1;display:inline-flex;justify-content:center;align-items:center;gap:10px;padding:16px 34px;border-radius:14px;font-weight:700;border:1px solid var(--v1-180-border);background:#fff;box-shadow:var(--v1-190-shadow);cursor:pointer;transition:all .2s}
    .v1-btn-261:hover{transform:translateY(-1px)}
    .v1-btn-blue-262{background:#1e40ff;color:#fff;border-color:#1e40ff}
    .v1-btn-green-263{background:#10b981;color:#052e16;border-color:#0ea76a}
    .v1-btn-ico-264{width:25px;height:25px}

    /* card wrapper look */
    .v1-details-card-270{background:var(--v1-110-card);border:1px solid var(--v1-180-border);border-radius:var(--v1-200-radius);padding:18px 20px;display:flex;gap:14px;align-items:center;width:100%;max-width:450px}

    /* responsiveness */
    @media (max-width: 990px){
      .v1-product-101{grid-template-columns:1fr}
      .v1-title-201{font-size:34px}
      .v1-gallery-110{grid-template-columns:1fr}
      .v1-thumbs-130{order:2;grid-template-columns:repeat(4,1fr)}
      .v1-thumb-131{height:90px;width:90px}
      .v1-hero-120{min-height:420px}
      .v1-details-card-270{max-width:100%}
    }
  </style>
</head>
<body>
  <main class="v1-wrap-100">
    <section class="v1-product-101">
      {% if single_product %}
      <!-- Left: Gallery -->
      <div class="v1-gallery-110">
        <div class="v1-thumbs-130">
          <a href="#"><img class="v1-thumb-131" src="{{ single_product.image1.url }}" alt="Thumbnail 1"></a>
          <a href="#"><img class="v1-thumb-131" src="{{ single_product.image2.url }}" alt="Thumbnail 2"></a>
          <a href="#"><img class="v1-thumb-131" src="{{ single_product.image3.url }}" alt="Thumbnail 3"></a>
          <a href="#"><img class="v1-thumb-131" src="{{ single_product.image4.url }}" alt="Thumbnail 4"></a>
        </div>

        <div class="v1-hero-120">
          <!-- If you have the product image, place it below and remove the gradient bg -->
          <img id="main-product-img" class="v1-hero-img-121" src="{{ single_product.image1.url }}" alt="Boat Earphones"> 
          
        </div>
      </div>

      <!-- Right: Details -->
       <form action="{% url 'carts:add_cart' single_product.id %}" method="POST">
        {% csrf_token %}
        <div class="container220">
          <div class="v1-details-200">
            <h1 class="v1-title-201">{{ single_product.product_name }}</h1>
            <p class="v1-sub-202">{{ single_product.discription }}</p>

            <div class="v1-price-210">
              <div class="v1-price-now-211">Rs.{{ single_product.price }}</div>
              {% if single_product.old_price %}
                <div class="v1-price-sale-212">Sale price <span class="v1-price-strike-213">Rs.{{ single_product.old_price }}</span></div>
              {% endif %}
            </div>
            <div class="v1-tax-214">NRP (Inclusive of all taxes)</div>

            <div class="v1-stars-220">
            <div class="rating-star">
                  <!-- 1 star -->
                  <i class="fa fa-star{% if single_product.averageReview < 0.5%}-o {% elif single_product.averageReview >= 0.5 and single_product.averageReview < 1 %}-half-o {% endif %}" aria-hidden="true"></i>
                  <!-- 2 star -->
                  <i class="fa fa-star{% if single_product.averageReview < 1.5%}-o {% elif single_product.averageReview >= 1.5 and single_product.averageReview < 2 %}-half-o {% endif %}" aria-hidden="true"></i>
                  <!-- 3 star -->
                  <i class="fa fa-star{% if single_product.averageReview < 2.5%}-o {% elif single_product.averageReview >= 2.5 and single_product.averageReview < 3 %}-half-o {% endif %}" aria-hidden="true"></i>
                  <!-- 4 star -->
                  <i class="fa fa-star{% if single_product.averageReview < 3.5%}-o {% elif single_product.averageReview >= 3.5 and single_product.averageReview < 4 %}-half-o {% endif %}" aria-hidden="true"></i>
                  <!-- 5 star -->
                  <i class="fa fa-star{% if single_product.averageReview < 4.5%}-o {% elif single_product.averageReview >= 4.5 and single_product.averageReview < 5 %}-half-o {% endif %}" aria-hidden="true"></i>
            </div>
              <span class="v1-rev-222">Rating {{ avg_rating|floatformat:1 }} | {{ single_product.countReview }} reviews</span>
            </div>

            <div class="v1-choose-230">Choose your color:</div>
            <div class="v1-swatches-231">
              <input type="hidden" name="color" id="selected-color-input">
              {% for i in single_product.variation_set.colors %}
                <span class="v1-pill-232" data-color="{{ i.variation_value | lower }}">
                  {{ i.variation_value | capfirst }}
                </span>

              {% endfor %}
            </div>

            <div class="v1-min-240">Minimum Order : 45 Units</div>

            <div class="v1-feats-250">
              {% if single_product %}
              <div class="v1-feat-251">
                <p class="v1-ico-252">{{ single_product.feature1 }}</p>
              </div>
              {% endif %}
              {% if single_product.feature2 %}
              <div class="v1-feat-251">
                <p class="v1-ico-252">{{ single_product.feature2 }}</p>
              </div>
              {% endif %}
              {% if single_product.feature3 %}
              <div class="v1-feat-251">
                <p class="v1-ico-252">{{ single_product.feature3 }}</p>
              </div>
              {% endif %}
            </div>

            <div class="v1-details-card-270">
              {% if single_product.stock <= 0 %}
				        <h5 class="text-danger" >Out of Stock</h5>
			        {% else %}
              <!-- Add to cart -->
                <button class="v1-btn-261 v1-btn-blue-262" type="submit">
                  <!-- Shopping cart icon -->
                  <svg class="v1-btn-ico-264" xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#E3E3E3">
                    <path d="M7 18q-.825 0-1.412-.587Q5 16.825 5 16t.588-1.413Q6.175 14 7 14t1.413.587Q9 15.175 9 16t-.587 1.413Q7.825 18 7 18Zm10 0q-.825 0-1.412-.587Q15 16.825 15 16t.588-1.413Q16.175 14 17 14t1.413.587Q19 15.175 19 16t-.587 1.413Q17.825 18 17 18ZM7 6.6l1.45 2.9h7.95l2.7-5.4H7ZM5.15 4h15.7q.45 0 .65.388.2.387-.05.787l-3.6 7.25q-.275.525-.75.85-.475.325-1.1.325H8.1l-.75 1.4h10.85v1.5H6q-.675 0-1.013-.6-.337-.6 0-1.2L6.3 11l-2.75-5.5h1.6L7 6.6Z"/>
                  </svg>
                  Add to Cart
                </button>

                <!-- Contact Us -->
                <button class="v1-btn-261 v1-btn-green-263" type="submit">
                  <!-- Call icon -->
                  <svg class="v1-btn-ico-264" xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="#E3E3E3">
                    <path d="M19.95 21q-3.3 0-6.462-1.275Q10.325 18.45 7.6 15.725 4.875 13 3.6 9.838 2.325 6.675 2.325 3.375q0-.375.262-.675Q2.85 2.4 3.3 2.25L7.05 1.3q.375-.1.7.05.325.15.525.5l2.1 3.9q.2.35.125.725-.075.375-.35.65l-2.25 2.3q.75 1.5 1.988 2.738 1.237 1.237 2.737 1.987l2.3-2.25q.275-.275.65-.35.375-.075.725.125l3.9 2.1q.35.2.5.525.15.325.05.7l-.95 3.75q-.1.45-.4.712-.3.263-.7.263Z"/>
                  </svg>
                  Contact Us
                </button>
              {% endif %}
            </div>


          </div>
        </div>
       </form>
      {% else %}
        <div class="row">
            <div class="col-md-12">
                <div class="alert alert-warning" role="alert">
                    <h4 class="alert-heading">Product Not Found!</h4>
                    <p>The product you're looking for doesn't exist or is no longer available.</p>
                    <hr>
                    <p class="mb-0">
                        <a href="{% url 'store' %}" class="btn btn-primary">Back to Store</a>
                    </p>
                </div>
            </div>
        </div>
      {% endif %}
      
    </section>
    <br>

    <div class="row">
            <div class="col-md-9">


        <form action="{% url 'submit_review' single_product.id %}" method="post">
          {% csrf_token %}
          <h5>Write your Review</h5>

          <div>
            <!-- Rating stars -->
             <label for="rating">How do you rate this product?</label>
             <br>
              <div class="rate">
                <input type="radio" id="rating10" name="rating" value="5" required/><label for="rating10" title="5"></label>
                <input type="radio" id="rating9" name="rating" value="4.5" required/><label class="half" for="rating9" title="4.5"></label>
                <input type="radio" id="rating8" name="rating" value="4" required/><label for="rating8" title="4"></label>
                <input type="radio" id="rating7" name="rating" value="3.5" required/><label class="half" for="rating7" title="3.5"></label>  
                <input type="radio" id="rating6" name="rating" value="3" required/><label for="rating6" title="3"></label>  
                <input type="radio" id="rating5" name="rating" value="2.5" required/><label class="half" for="rating5" title="2.5"></label>
                <input type="radio" id="rating4" name="rating" value="2" required/><label for="rating4" title="2"></label>
                <input type="radio" id="rating3" name="rating" value="1.5" required/><label class="half" for="rating3" title="1.5"></label>
                <input type="radio" id="rating2" name="rating" value="1" required/><label for="rating2" title="1"></label>
                <input type="radio" id="rating1" name="rating" value="0.5" required/><label class="half" for="rating1" title="0.5"></label>
              </div>
              <br>


            Review Title:
            <input type="text" name="subject" class="form-control">
            <br>
            Reviews:
            <textarea name="review" rows="4" class="form-control"></textarea>
            <br>
            {% if user.is_authenticated %}
              {% if orderproduct %}
                <input type="submit" value="Submit Review" class="btn btn-primary">
              {% else %}
                <p>You must purchase the product to review it.</p>
              {% endif %}
            {% else %}
            <p>Please <a href="{% url 'login' %}">login</a> to submit a review.</p>
            {% endif %}
          </div>
{% include 'includes/alerts.html' %}

        </form>
        <br>
        <header class="section-heading">
          <h3>Customer Reviews </h3>  
          <div class="rating-star">
                <!-- 1 star -->
                <i class="fa fa-star{% if single_product.averageReview < 0.5%}-o {% elif single_product.averageReview >= 0.5 and single_product.averageReview < 1 %}-half-o {% endif %}" aria-hidden="true"></i>
                <!-- 2 star -->
                <i class="fa fa-star{% if single_product.averageReview < 1.5%}-o {% elif single_product.averageReview >= 1.5 and single_product.averageReview < 2 %}-half-o {% endif %}" aria-hidden="true"></i>
                <!-- 3 star -->
                <i class="fa fa-star{% if single_product.averageReview < 2.5%}-o {% elif single_product.averageReview >= 2.5 and single_product.averageReview < 3 %}-half-o {% endif %}" aria-hidden="true"></i>
                <!-- 4 star -->
                <i class="fa fa-star{% if single_product.averageReview < 3.5%}-o {% elif single_product.averageReview >= 3.5 and single_product.averageReview < 4 %}-half-o {% endif %}" aria-hidden="true"></i>
                <!-- 5 star -->
                <i class="fa fa-star{% if single_product.averageReview < 4.5%}-o {% elif single_product.averageReview >= 4.5 and single_product.averageReview < 5 %}-half-o {% endif %}" aria-hidden="true"></i>
                <span>Rating | {{ single_product.countReview }} reviews</span>
            </div>
        </header>

      {%  for review in reviews %}
        <article class="box mb-3">
          <div class="icontext w-100">

            <div class="text">
              <span class="date text-muted float-md-right">{{review.updated_date}}</span>  
              <h6 class="mb-1">{{review.user.full_name}} </h6>
              <div class="rating-star">
                <!-- 1 star -->
                <i class="fa {% if review.rating >= 1 %}fa-star{% elif review.rating >= 0.5 %}fa-star-half-o{% else %}fa-star-o{% endif %}" aria-hidden="true"></i>
                <!-- 2 star -->
                <i class="fa {% if review.rating >= 2 %}fa-star{% elif review.rating >= 1.5 %}fa-star-half-o{% else %}fa-star-o{% endif %}" aria-hidden="true"></i>
                <!-- 3 star -->
                <i class="fa {% if review.rating >= 3 %}fa-star{% elif review.rating >= 2.5 %}fa-star-half-o{% else %}fa-star-o{% endif %}" aria-hidden="true"></i>
                <!-- 4 star -->
                <i class="fa {% if review.rating >= 4 %}fa-star{% elif review.rating >= 3.5 %}fa-star-half-o{% else %}fa-star-o{% endif %}" aria-hidden="true"></i>
                <!-- 5 star -->
                <i class="fa {% if review.rating >= 5 %}fa-star{% elif review.rating >= 4.5 %}fa-star-half-o{% else %}fa-star-o{% endif %}" aria-hidden="true"></i>
              </div>
              
            </div>
          </div> <!-- icontext.// -->
          <div class="mt-3">
            <h6>
              {{review.subject}}
            </h6>
            <p>
              {{review.review}}
            </p>	
          </div>
        </article>
      {% endfor %}

        

        </div> <!-- col.// -->
    </div> <!-- row.// -->
  </main>
</body>

      <!-- JS  -->

<script>



 const mainImg = document.getElementById("main-product-img");
  const thumbs = document.querySelectorAll(".v1-thumb-131");

  // Thumbnail switching
  thumbs.forEach(thumb => {
    thumb.addEventListener("click", () => {
      mainImg.src = thumb.src;
      thumbs.forEach(t => t.classList.remove("active"));
      thumb.classList.add("active");
    });
  });

  // Zoom effect
  mainImg.addEventListener("mousemove", function (e) {
    const { left, top, width, height } = mainImg.getBoundingClientRect();
    const x = ((e.pageX - left) / width) * 100;
    const y = ((e.pageY - top) / height) * 100;

    mainImg.style.transformOrigin = `${x}% ${y}%`;
    mainImg.style.transform = "scale(2)"; // zoom level
  });

  mainImg.addEventListener("mouseleave", function () {
    mainImg.style.transformOrigin = "center center";
    mainImg.style.transform = "scale(1)";
  });


  // Thumbnail switching (your code stays the same)

  // Swatch selection
  const swatches = document.querySelectorAll(".v1-pill-232");
  if (swatches.length > 0) {
    // default: first one active
    swatches[0].classList.add("active");

    swatches.forEach(swatch => {
      swatch.addEventListener("click", () => {
        swatches.forEach(s => s.classList.remove("active"));
        swatch.classList.add("active");
      });
    });
  }

  // Swatch selection
const selectedColorInput = document.getElementById("selected-color-input");

if (swatches.length > 0) {
  swatches[0].classList.add("active");
  selectedColorInput.value = swatches[0].textContent.trim().toLowerCase();  // Set default

  swatches.forEach(swatch => {
    swatch.addEventListener("click", () => {
      swatches.forEach(s => s.classList.remove("active"));
      swatch.classList.add("active");

      selectedColorInput.value = swatch.textContent.trim().toLowerCase();
    });
  });
}


  // Zoom effect (your code stays the same)

</script>



</html>

<!-- ========================= SECTION CONTENT END// ========================= -->

{% endblock %}